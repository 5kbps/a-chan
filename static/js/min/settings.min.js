"use strict";function byID(a){return document.getElementById(a)}function byClass(a){return document.getElementsByClassName(a)}function byTag(a){return document.getElementsByTagName(a)}function byName(a){return document.getElementsByName(a)}function Cycle(a,b){for(var c=0;a>c;c++)b(c)}function CycleThrough(a,b){for(var c in a)a.hasOwnProperty(c)&&"length"!=c&&b(c)}function pushStyle(a){var b=newElement("style");return b.innerHTML=a,document.head.appendChild(b),b}function collect(){for(var a={},b=arguments.length,c=0;b>c;c++)for(var d in arguments[c])arguments[c].hasOwnProperty(d)&&(a[d]=arguments[c][d]);return a}function newElement(a){return document.createElement(a)}function newTextNode(a){return document.createTextNode(a)}function insertAfter(a,b){var c=b.parentNode,d=b.nextSibling;return d?c.insertBefore(a,d):c.appendChild(a)}function stopPropagation(a){"function"==typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function getOffset(a){var b=a.getBoundingClientRect();return{x:b.left,y:b.top,right:b.right,bottom:b.bottom,h:b.height,w:b.width}}function normalizeIntLength(a,b,c){if(c=c?c:"0",a+="",a.length<b)for(var d=0;d<b-a.length;d++)a=c+a;return a}function getInt(a){for(var b=[],c=0;c<a.length;c++)-1!="1234567890".indexOf(a[c])?b.push(a[c]):0;return 1*b.join([])}function genPassword(){for(var a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",b="",c=0;10>c;c++){var d=Math.floor(Math.random()*a.length);b+=a.substring(d,d+1)}return b}function ellipsis(a,b){var c="...";return a.length>b-c.length?a.substr(0,b)+c:a}function getWindowSize(){var a=window,b=document,c=b.documentElement,d=b.getElementsByTagName("body")[0],e=a.innerWidth||c.clientWidth||d.clientWidth,f=a.innerHeight||c.clientHeight||d.clientHeight;return{x:e,y:f}}function loadSettings(){"undefined"==typeof localStorage.settings&&applyDefaultSettings(),Settings=JSON.parse(localStorage.settings),Settings||(Settings=[])}function getSetting(a){return Settings||loadSettings(),"time_format"==a&&1*getSetting("time_format_i")<2&&(Settings[a]=DefaultSettings[a],Settings.time_format_i=2,saveSettings()),"undefined"==typeof Settings[a]?"undefined"==typeof DefaultSettings[a]?!1:(Settings[a]=DefaultSettings[a],saveSettings(),DefaultSettings[a]):Settings[a]}function getPostNumByElem(a){for(;a.parentNode;){if("reply"==a.className||"thread"==a.className)return getInt(a.id);a=a.parentNode}return null}function applyDefaultSettings(){Settings=DefaultSettings,saveSettings()}function saveSettings(){localStorage.settings=JSON.stringify(Settings)}function setCookie(a,b,c){c=c||{};var d=c.expires;if("number"==typeof d&&d){var e=new Date;e.setTime(e.getTime()+1e3*d),d=c.expires=e}d&&d.toUTCString&&(c.expires=d.toUTCString()),b=encodeURIComponent(b);var f=a+"="+b;for(var g in c){f+="; "+g;var h=c[g];h!==!0&&(f+="="+h)}document.cookie=f}function getCookie(a){var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):""}function isMobile(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function constructElementTree(a){var b,c,d=[];a=a.map(newElement),b=a[0],c=b,d.push(b);for(var e=1;e<a.length;e++)b.appendChild(a[e]),d.push(a[e]),console.log(a[e]),console.log(d),b=a[e];return{list:d,last:b,first:c}}function constructElementList(a){return a.map(newElement)}function decodeHTML(a){var b=newElement("span");return b.innerHTML=a,b.textContent}function showMessage(a,b){var c;byID("message-div")?c=byID("message-div"):(c=newElement("div"),c.className="reply-like",c.id="message-div",c.onclick=function(){this.remove()}),document.body.appendChild(c),c.textContent=a,b&&setTimeout(function(){hideMessage()},1e3*b)}function getSelectionText(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(a=document.selection.createRange().text),a}function rkmSave(a){}function insert(a){var b;b=""==getSelectionText()?"":"> ",document.getElementsByName("message")[0].value=document.getElementsByName("message")[0].value+a+b+getSelectionText()}function replaceSelectedText(a,b){var c=getInputSelection(a),d=a.value;a.value=d.slice(0,c.start)+b+d.slice(c.end)}function getInputSelection(a){var b,c,d,e,f,g=0,h=0;return"number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd?(g=a.selectionStart,h=a.selectionEnd):(c=document.selection.createRange(),c&&c.parentElement()==a&&(e=a.value.length,b=a.value.replace(/\r\n/g,"\n"),d=a.createTextRange(),d.moveToBookmark(c.getBookmark()),f=a.createTextRange(),f.collapse(!1),d.compareEndPoints("StartToEnd",f)>-1?g=h=e:(g=-d.moveStart("character",-e),g+=b.slice(0,g).split("\n").length-1,d.compareEndPoints("EndToEnd",f)>-1?h=e:(h=-d.moveEnd("character",-e),h+=b.slice(0,h).split("\n").length-1)))),{start:g,end:h}}function postReply(a,b,c,d){if(!d){var e=byID("message");isHidden(b)&&postShow(0,b);var f=getSelection(),g=f.toString().trim(),h=addCitation(byID("message").value,g,b);if(e.value=h[0],"none"!=e.style.display){if(g)setSelectionRange(e,h[1],h[1]);else{var i=e.value.length;setSelectionRange(e,i,i)}setTimeout(function(){e.focus()},10)}}var j=byID("postform-container-"+b);j&&(j.appendChild(byID("postform")),byName("replythread")[0].value=c,byID("posttypeindicator").textContent=_("To thread")+" ",byID("formpostlink").href=document.location.protocol+"//"+document.location.host+"/"+config.board+"/res/"+c+".html#"+b,byID("formpostlink").textContent=c,config.thread||(byID("clearreplyto").style.display="inline-block",byID("formpostlink").style.display="inline-block",byID("clearreplyto").innerHTML=config.clearreplyto_text))}function addTagSel(a,b){var c=["[","]"],d=c[0]+a+c[1],e=c[0]+"/"+a+c[1],f=!1;if(f){var g=document.selection.createRange(),h=b.createTextRange(),i=h.duplicate();i.moveToBookmark(g.getBookmark()),h.setEndPoint("EndToStart",i);var j=d+g.text+e,k=b.value.replace(/[\r\n]/g,".").indexOf(g.text.replace(/[\r\n]/g,"."),h.text.length);b.value=b.value.substring(0,k)+j+b.value.substring(k+j.length,b.value.length);var l=b.value.length-e.length;h.collapse(!0),h.moveEnd("character",l),h.moveStart("character",l),h.select()}else if(b.selectionStart||"0"==b.selectionStart){var m=b.selectionStart,n=b.selectionEnd,j=d+b.value.substring(m,n)+e;b.value=b.value.substring(0,m)+j+b.value.substring(n,b.value.length),b.setSelectionRange(n+d.length,n+d.length),b.focus()}return j}function addTagToMsg(a){addTagSel(a,byID("message"))}function addCitation(a,b,c){var d,e=0;if(b&&(b="> "+b.trim().replaceAll("\n","\n> ").replaceAll("> \n","")),-1!=a.indexOf(">>"+c)){for(var f=a.split(/>>/),g=1;g<f.length;g++){var h=f[g];if(h){if(!h.indexOf(c)&&b){d=">>"+h.trim()+"\n"+b.trim()+"\n",b="",e+=d.length,f[g]=d;continue}d=">>"+h,b&&(e+=d.length),f[g]=d}else d=h,b&&(e+=d.length),f[g]=d}return[f.join(""),e]}a=a.trim(),a&&(a+="\n");var i=a+">>"+c+"\n"+b+(b?"\n":"");return[i,i.length]}function setSelectionRange(a,b,c){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,c);else if(a.createTextRange){var d=a.createTextRange();d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",b),d.select()}}function hideMessage(){byID("message-div")?byID("message-div").remove():""}function formatDate(a,b,c){function d(a,b){var c=a+"";for(b=b||2;c.length<b;)c="0"+c;return c}var e=TimeFormats.MMMM,f=TimeFormats.MMM,g=TimeFormats.dddd,h=TimeFormats.ddd,i=c?a.getUTCFullYear():a.getFullYear();b=b.replace(/(^|[^\\])yyyy+/g,"$1"+i),b=b.replace(/(^|[^\\])yy/g,"$1"+i.toString().substr(2,2)),b=b.replace(/(^|[^\\])y/g,"$1"+i);var j=(c?a.getUTCMonth():a.getMonth())+1;b=b.replace(/(^|[^\\])MMMM+/g,"$1"+e[0]),b=b.replace(/(^|[^\\])MMM/g,"$1"+f[0]),b=b.replace(/(^|[^\\])MM/g,"$1"+d(j)),b=b.replace(/(^|[^\\])M/g,"$1"+j);var k=c?a.getUTCDate():a.getDate();b=b.replace(/(^|[^\\])dddd+/g,"$1"+g[0]),b=b.replace(/(^|[^\\])ddd/g,"$1"+h[0]),b=b.replace(/(^|[^\\])dd/g,"$1"+d(k)),b=b.replace(/(^|[^\\])d/g,"$1"+k);var l=c?a.getUTCHours():a.getHours();b=b.replace(/(^|[^\\])HH+/g,"$1"+d(l)),b=b.replace(/(^|[^\\])H/g,"$1"+l);var m=l>12?l-12:0==l?12:l;b=b.replace(/(^|[^\\])hh+/g,"$1"+d(m)),b=b.replace(/(^|[^\\])h/g,"$1"+m);var n=c?a.getUTCMinutes():a.getMinutes();b=b.replace(/(^|[^\\])mm+/g,"$1"+d(n)),b=b.replace(/(^|[^\\])m/g,"$1"+n);var o=c?a.getUTCSeconds():a.getSeconds();b=b.replace(/(^|[^\\])ss+/g,"$1"+d(o)),b=b.replace(/(^|[^\\])s/g,"$1"+o);var p=c?a.getUTCMilliseconds():a.getMilliseconds();b=b.replace(/(^|[^\\])fff+/g,"$1"+d(p,3)),p=Math.round(p/10),b=b.replace(/(^|[^\\])ff/g,"$1"+d(p)),p=Math.round(p/10),b=b.replace(/(^|[^\\])f/g,"$1"+p);var q=12>l?"AM":"PM";b=b.replace(/(^|[^\\])TT+/g,"$1"+q),b=b.replace(/(^|[^\\])T/g,"$1"+q.charAt(0));var r=q.toLowerCase();b=b.replace(/(^|[^\\])tt+/g,"$1"+r),b=b.replace(/(^|[^\\])t/g,"$1"+r.charAt(0));var s=-a.getTimezoneOffset(),t=c||!s?"Z":s>0?"+":"-";if(!c){s=Math.abs(s);var u=Math.floor(s/60),v=s%60;t+=d(u)+":"+d(v)}b=b.replace(/(^|[^\\])K/g,"$1"+t);var w=(c?a.getUTCDay():a.getDay())+1;return b=b.replace(new RegExp(g[0],"g"),g[w]),b=b.replace(new RegExp(h[0],"g"),h[w]),b=b.replace(new RegExp(e[0],"g"),e[j]),b=b.replace(new RegExp(f[0],"g"),f[j]),b=b.replace(/\\(.)/g,"$1")}function formatTime(){if(getSetting("time_formatting")){for(var a=getSetting("time_format");byClass("raw-timestamp")[0];){var b=byClass("raw-timestamp")[0],c=1e3*b.value,d=new Date(c),e=formatDate(d,a),f=b.nextSibling;f.innerHTML=e,b.className="raw-timestamp-used"}hideFormattedTimestamp()}}function hideFormattedTimestamp(){if(!byID("formatted_timestamp_css")){var a=newElement("style");a.id="formatted_timestamp_css",a.innerHTML=".formatted_timestamp{display:none;}",document.head.appendChild(a)}}function doSpoilers(){getSetting("expandspoilers")||pushStyle(".fspoilertext{display:none;}")}function toggleSpoiler(a){var b=a.parentNode.byClass("fspoilertext")[0];-1==b.className.indexOf("fspoileropen")?b.className+=" fspoileropen ":b.className=b.className.replaceAll("fspoileropen","")}function insertPasswords(){byName("postpassword").length<2||(byName("postpassword")[0].value=getSetting("password"),byName("postpassword")[1].value=getSetting("password"))}function insertPreferences(){byName("preference")[0]&&(byName("preference")[0].value=getSetting("preference"))}function clearreplyto(){config.thread||(byID("clearreplyto").style.display="none",byID("clearreplyto").innerHTML="",byClass("postarea")[0].appendChild(byID("postform")),byID("posttypeindicator").textContent=_("New thread"),byID("formpostlink").href=document.location.protocol+"//"+document.location.host+"/"+config.board+"/",byID("formpostlink").textContent="",byID("formpostlink").style.display="none",byName("replythread")[0].value="0")}function getAllPostNumbers(){for(var a=[],b=byClass("post-number"),c=0;c<b.length;c++)a.push(getInt(b[c].id));return a}function clearFileSelect(){byID("fileupload-clear").style.display="none",byID("fileupload-list").innerHTML="",byID("fileupload").value=""}function handleFileSelect(a){byID("fileupload-list").innerHTML="",byID("fileupload-clear").style.display="inline";for(var b,c=a.target.files,d=0;b=c[d];d++)if(b.type.match("image.*")){var e=new FileReader;e.onload=function(a){return function(b){var c=newElement("span");c.innerHTML=['<img class="preloadthumb" title="'+_("Preview selected image")+'" src="',b.target.result,'" title="',escape(a.name),'"/>'].join(""),byID("fileupload-list").insertBefore(c,null)}}(b),e.readAsDataURL(b)}}function imgExpand(a,b,c,d){return a.hasClass("thumb-loading")?(a.src=c,a.className="thumb"):a.hasClass("thumb-expanded")?(a.className="thumb",a.src=c):(a.className="thumb thumb-loading",a.src=b,a.onload=function(){a.className="thumb thumb-expanded",a.onload=function(){}},a.onabort=function(){alert("cancel")}),d.preventDefault(),!1}function webmExpand(a){var b=a.parentNode.parentNode.href,c=newElement("span");c.className="webm-hide",c.textContent=_("Close"),c.onclick=function(a){webmClose(a)};var d=newElement("video");d.className="webm-video",d.autoplay=!0,d.controls=!0;var e=newElement("source");e.type="video/webm",e.src=b,d.appendChild(e),a.parentNode.parentNode.parentNode.insertAfter(c,a.parentNode.parentNode),a.parentNode.parentNode.parentNode.insertAfter(d,a.parentNode.parentNode),a.addClass("hidden-element")}function webmClose(a){var b=a.target;if(b.parentNode.byClass("webm-video")[0]&&b.parentNode.byClass("webm-video")[0].remove(),b.parentNode.byClass("webm-thumb")[0]&&b.parentNode.byClass("webm-thumb")[0].removeClass("hidden-element"),b.remove(),!a)var a=window.event;a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation(),a.preventDefault()}function rollLogo(){cache.rollLogo||(cache.rollLogo=0),cache.rollLogo++;var a=byID("logo-image-top"),b="rotate("+360*cache.rollLogo+"deg)";a.pushStyleArray({"-moz-transform":b,"-webkit-transform":b,"-ms-transform":b,"-o-transform":b,transform:b})}function scrollToEnd(){window.scroll(0,document.body.clientWidth)}function updateTitle(){if(!config.ispage){var a,b,c,d,e,f;if(c=getSetting("title_format"),d=byClass(config.new_post_class).length,d=d&&d>0?"("+d+") ":"",f=config.board,e=decodeHTML(config.boardNames[f]?" - "+config.boardNames[f]:""),config.thread)try{a=" - "+ellipsis(byClass("filetitle-thread")?byClass("filetitle-thread")[0].textContent.trim():"",30),b=" - "+ellipsis(byClass("posttext")?byClass("posttext")[0].textContent.trim():"",30)}catch(g){a="",b=" - "+_("Thread №")+config.thread}else a="",b="";c=d+"/"+f+"/ "+a+b+e,document.title=c}}function faviconCounter(){if(getSetting("tab_notification")){var a=byClass(config.board_link_counter_class).length;byID("favicon").href=a?"/favicon*.ico?":"/favicon.ico?"}}function highlightPostInURL(){for(var a=byClass(config.outlined_post_class),b=0;b<a.length;b++){var c=a[b];c.removeClass(config.outlined_post_class)}var d=1*document.location.href.split("#")[1];isNaN(d)||byID("reply"+d)&&byID("reply"+d).addClass(config.outlined_post_class)}function initConfig(){config.board=byName("board")[0].value}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _(a){return"undefined"!=typeof getText[getSetting("language")]&&"undefined"!=typeof getText[getSetting("language")][a]?getText[getSetting("language")][a]:a}function translateUI(){var a=byClass("gt");CycleThrough(a,function(b){var c=a[b],d=c.tagName.toLowerCase();-1!=["input"].indexOf(d)?c.value=_(c.value):c.textContent=_(c.textContent)})}function defaultSettings(){for(var a=0;DefaultSettings>a;a++){var b=DefaultSettings[a];if(byID(b)){var c=byID(b);"checkbox"==c.type?c.checked=!!DefaultSettings[b]:byID(b).value=DefaultSettings[b],byID(b+"-value")&&(byID(b+"-value").textContent=DefaultSettings[b]+"")}}var d=byID("watchboards-p");d.innerHTML="";for(var a=(getSetting("ignored_boards").split(","),0);a<config.boards.length;a++){var e=config.boards[a],f=newElement("label");f["for"]="wb-"+e,f.className="wb-item";var g=newTextNode("/"+e+"/"),h=newElement("input");h.type="checkbox",h.id="wb-"+e,h.className="wb-box",h.checked=!0,f.appendChild(h),f.appendChild(g),d.appendChild(f)}byID("reflinks_position").value="bottom",byID("center_posts").checked=DefaultSettings.center_posts,applySettings(),showMessage(_("Default values were applied"))}function applySettings(){Settings.autoupdate=byID("autoupdate").checked,Settings.updateinterval=byID("updateinterval").value,Settings.time_formatting=byID("time_formatting").checked,Settings.time_format=byID("time_format").value,Settings.reflinks=byID("reflinks").checked,Settings.reflist_on_top="top"==byID("reflinks_position").value,Settings.youtube=byID("youtube").checked,Settings.youtube_info=byID("youtube_info").checked,Settings.max_youtube=byID("max_youtube").value,Settings.expandspoilers=byID("expandspoilers").checked,Settings.tab_notification=byID("tab_notification").checked;var a=byClass("wb-box"),b=[];CycleThrough(a,function(c){var d=a[c],e=d.id.split("-")[1];d.checked||b.push(e)}),Settings.ignored_boards=b.join(","),checkBoxToCookie(byID("center_posts")),showMessage(_("Saved")),saveSettings(),timeFormatPreview()}function toggleHelp(a){var b=byID("help-"+a.id.split("-")[1]);b.style.display="none"==b.style.display?"block":"none"}function timeFormatPreview(){var a=new Date(Date.now());byID("time-preview").innerHTML=formatDate(a,byID("time_format").value)}function checkBoxToCookie(a){var b=a.id;setCookie(b,a.checked,{expires:864e4,path:"/"})}function init(){loadSettings(),config.boards=["a","b","cu","sp","d","vg"],translateUI();for(var a=0;a<byClass("help").length;a++)byClass("help")[a].style.display="none";for(var a=0;a<byClass("help-toggle").length;a++)byClass("help-toggle")[a].onclick=function(){toggleHelp(this)};byID("autoupdate").checked=getSetting("autoupdate"),byID("updateinterval-value").textContent=getSetting("updateinterval"),byID("max_youtube-value").textContent=getSetting("max_youtube"),byID("updateinterval").value=getSetting("updateinterval");for(var b=byID("watchboards-p"),c=getSetting("ignored_boards").split(","),a=0;a<config.boards.length;a++){var d=config.boards[a],e=newElement("label");e["for"]="wb-"+d,e.className="wb-item";var f=newTextNode("/"+d+"/"),g=newElement("input");g.type="checkbox",g.id="wb-"+d,g.className="wb-box",g.checked=!c.hasValue(d),e.appendChild(g),e.appendChild(f),b.appendChild(e)}byID("time_formatting").checked=getSetting("time_formatting"),byID("time_format").value=getSetting("time_format"),byID("reflinks").checked=getSetting("reflinks"),byID("reflinks_position").value=getSetting("reflist_on_top")?"top":"bottom",byID("youtube").checked=getSetting("youtube"),byID("youtube_info").checked=getSetting("youtube_info"),byID("max_youtube").value=getSetting("max_youtube"),byID("expandspoilers").checked=getSetting("expandspoilers"),byID("tab_notification").checked=getSetting("tab_notification"),byID("style").value=getStyle(),byID("center_posts").checked="true"==getCookie("center_posts"),timeFormatPreview()}function handleRange(a){byID(a.id+"-value").textContent=a.value}function checkStyle(a){return cache.appliedStyle?void(cache.appliedStyle!=getStyle()+" "+getCookie("center_posts")&&(changeStyle(getStyle()),saveAppliedStyle(),"function"==typeof a&&a())):void saveAppliedStyle()}function changeStyle(a){setCookie("style",a,{expires:864e4,path:"/"}),setTimeout(function(){byID("styleman").href=document.location.protocol+"//"+document.location.host+config.style_path+"?"+Math.random()},10)}function getStyle(){return getCookie("style")?getCookie("style"):config.default_style}function saveAppliedStyle(){cache.appliedStyle=getStyle()+" "+getCookie("center_posts")}Object.prototype.getKeys=function(){var a=[];for(var b in this)this.hasOwnProperty(b)&&a.push(b);return a},Object.prototype.hasKey=function(a){for(var b in this)if(this.hasOwnProperty(b)&&b==a)return!0;return!1},Object.prototype.hasValue=function(a){for(var b in this)if(this.hasOwnProperty(b)&&this[b]==a)return!0;return!1},Object.prototype.append=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},Element.prototype.setProperties=function(a){for(var b in a)this[b]=a[b]},Element.prototype.byID=function(a){return this.getElementById(a)},Element.prototype.pushStyleArray=function(a){for(var b in a)this.style[b]=a[b]},Element.prototype.byClass=function(a){return this.getElementsByClassName(a)},Element.prototype.byTag=function(a){return this.getElementsByTagName(a)},Element.prototype.hasClass=function(a){for(var b=this.className.split(" "),c=0;c<b.length;c++)if(b[c]==a)return!0;return!1},Element.prototype.insertAfter=function(a,b){var c=b.nextSibling;return c?this.insertBefore(a,c):this.appendChild(a)},Element.prototype.addClass=function(a){for(var b=this.className.split(" "),c=0;c<b.length;c++)if(b[c]==a)return;this.className+=" "+a},Element.prototype.removeClass=function(a){for(var b=this.className.split(" "),c=[],d=0;d<b.length;d++)b[d]!=a&&c.push(b[d]);this.className=c.join(" ")},Array.prototype.inArray=function(a){for(var b in this)if(this.hasOwnProperty(b)&&this[b]==a)return!0;return!1},Array.prototype.getProperties=function(a,b){var c=[],b=b?b:1;for(var d in this)if(this.hasOwnProperty(d)){for(var e=this[d],f=0;b>f;f++)e=e[a];c.push(e)}return c},String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)},HTMLCollection.prototype.map||(HTMLCollection.prototype.map=function(a){for(var b=0;b<this.length;b++)a(this[b])});var config={hide_posts_mouse_move_delta:100,op_reflist_on_top:!1,reply_reflist_on_top:!1,reflink_prefix:">>",reflink_op_postfix:"[OP]",reflink_self_postfix:"[GET]",post_reflink_text:"No. ",highlight_timeout:5e3,clearreplyto_text:"[x]",min_update_interval:2e4,highlighted_post_delay:150,default_style:"Muon",style_path:"/static/style.php",board_path:"board.php",reply_like_class:"reply-like",loaded_post_class:"loaded-post",highlighted_post_class:"highlighted-post",outlined_post_class:"outlined-post",delform_id:"del-form",new_post_class:"new-post",underlined_link_id:"underlined-link",board_link_counter_class:"board-link-counter",favicon_path:"/favicon.ico",cpuboiler_path:"/static/js/src/cpuboiler.js",captcha_min_length:1,pow_allowed:!0,api_path:"api.php",is_mobile:"function"==typeof isMobile?isMobile():!1,"snow-delay":2,"snow-speed":1,max_script_execution_time:3e3};"undefined"!=typeof getWindowSize&&(config=collect({loaded_post_min_width:300,loaded_post_max_width:getWindowSize().x>1e3?1e3:getWindowSize().x-10},config));var DefaultSettings={time_formatting:!1,time_format:"dd.MM.yyyy (ddd) <b>HH:mm</b>:ss",time_format_i:1,highlight_posts:!1,title_format:"counter /boarddir/ - subject text boardname",update:!1,autoupdate:!0,updateinterval:40,language:"ru",reflinks:!0,youtube:!0,max_youtube:1,youtube_info:!0,center_posts:!1,ignored_boards:"",hidden_boards:"",expandspoilers:!1,saveimages:!0,noinit:!1,unsafe_init:!1,reflist_on_top:!1,tab_notification:!0,ajax_post_send:!1,preference:"pow",hidden:{},last_posts:{},password:"function"==typeof genPassword?genPassword():"",debug:!1},Ref,flags={mouseposition:{x:0,y:0}},cache={posts:{},requests:{},youtube:{},new_posts:{},check_passed:!1,pow_status:0,captcha_status:0,timeout_status:0,last_check:0,last_check_content:""},Settings,_ru,getText={ru:(_ru={Jan:"Янв",Feb:"Фев",Mar:"Мар",Apr:"Апр",May:"Май",Jun:"Июн",Jul:"Июл",Aug:"Авг",Sep:"Сен",Oct:"Окт",Nov:"Ноя",Dec:"Дек",January:"Январь",February:"Февраль",March:"Март",April:"Апрель"},_defineProperty(_ru,"May","Май"),_defineProperty(_ru,"June","Июнь"),_defineProperty(_ru,"July","Июль"),_defineProperty(_ru,"August","Август"),_defineProperty(_ru,"September","Сентябрь"),_defineProperty(_ru,"October","Октябрь"),_defineProperty(_ru,"November","Ноябрь"),_defineProperty(_ru,"December","Декабрь"),_defineProperty(_ru,"Mon","Пнд"),_defineProperty(_ru,"Tue","Втр"),_defineProperty(_ru,"Wed","Срд"),_defineProperty(_ru,"Thu","Чтв"),_defineProperty(_ru,"Fri","Птн"),_defineProperty(_ru,"Sat","Сбт"),_defineProperty(_ru,"Sun","Вск"),_defineProperty(_ru,"Monday","Понедельник"),_defineProperty(_ru,"Tuesday","Вторник"),_defineProperty(_ru,"Wednesday","Среда"),_defineProperty(_ru,"Thursday","Четверг"),_defineProperty(_ru,"Friday","Пятница"),_defineProperty(_ru,"Saturday","Суббота"),_defineProperty(_ru,"Sunday","Воскресенье"),_defineProperty(_ru,"Loading...","Загрузка..."),_defineProperty(_ru,"Processing response...","Обработка ответа..."),_defineProperty(_ru,"Something went wrong!","Ошибка!"),_defineProperty(_ru,"Thread expanded","Тред раскрыт"),_defineProperty(_ru,"Saved","Сохранено"),_defineProperty(_ru,"Autoupdate","Автообновление"),_defineProperty(_ru,"Autoupdate thread","Автообновление треда"),_defineProperty(_ru,"Interval","Интервал"),_defineProperty(_ru,"s.","с."),_defineProperty(_ru,"Notifications","Уведомления о новых постах"),_defineProperty(_ru,"Appearance","Оформление"),_defineProperty(_ru,"Buttons for text formatting in post form","Кнопки форматирования в форме поста."),_defineProperty(_ru,"Date format","Формат даты"),_defineProperty(_ru,"Year","Год"),_defineProperty(_ru,"Month","Месяц"),_defineProperty(_ru,"Day","День"),_defineProperty(_ru,"Weekday","День недели"),_defineProperty(_ru,"Hour","Час"),_defineProperty(_ru,"Minute","Минута"),_defineProperty(_ru,"Second","Секунда"),_defineProperty(_ru,"HTML tags are allowed","Можно использовать HTML-теги"),_defineProperty(_ru,"Show reflinks","Отображать обратные ссылки"),_defineProperty(_ru,"Reflinks position:","Расположение ссылок:"),_defineProperty(_ru,"Bottom","Снизу"),_defineProperty(_ru,"Top","Сверху"),_defineProperty(_ru,"Center posts","Посты по центру"),_defineProperty(_ru,"Tab Notifications","Значок на вкладке"),_defineProperty(_ru,"Show quick format buttons","Кнопки быстрого форматирования"),_defineProperty(_ru,"Show YouTube preview","Отображать превью для YouTube"),_defineProperty(_ru,"Load video title and duration","Загружать длительность и заголовок видео"),_defineProperty(_ru,"YouTube previews in post","Количество превью для YouTube в посте"),_defineProperty(_ru,"Expand spoilers","Раскрывать спойлеры"),_defineProperty(_ru,"Interface language","Язык интерфейса"),_defineProperty(_ru,"Thread Saving","Сохранение тредов"),_defineProperty(_ru,"Save original images","Сохранять оригиналы файлов"),_defineProperty(_ru,"Defaults","По умолчанию"),_defineProperty(_ru,"Apply","Применить"),_defineProperty(_ru,"Default values were applied","Установлены значения по умолчанию"),_defineProperty(_ru,"Replies:","Ответы:"),_defineProperty(_ru,"New thread","Новый тред"),_defineProperty(_ru,"To thread","В тред"),_defineProperty(_ru,"Subject","Тема"),_defineProperty(_ru,"Message","Текст"),_defineProperty(_ru,"File","Файл"),_defineProperty(_ru,"No File","Без файла"),_defineProperty(_ru,"Password","Пароль"),_defineProperty(_ru,"Loaded:","Загружено:"),_defineProperty(_ru,"posts","постов"),_defineProperty(_ru,"Thread №","Тред №"),_defineProperty(_ru,"or","или"),_defineProperty(_ru,"expand thread","развернуть тред"),_defineProperty(_ru,"Style:","Стиль:"),_defineProperty(_ru,"No new posts","Нет новых постов"),_defineProperty(_ru,"Post not found!","Пост не найден"),_defineProperty(_ru,"Error: unknown error.","Ошибка: неизвестная ошибка."),_defineProperty(_ru,"Error: no internet connection","Ошибка: нет соединения с интернетом"),_defineProperty(_ru,"Error: thread not found (404)","Ошибка: тред не найден (404)"),_defineProperty(_ru,"Error: server sent corrupted data.","Ошибка: сервер отправил поврежденные данные."),_defineProperty(_ru,"preview","просмотр"),_defineProperty(_ru,"New posts:","Новых постов:"),_defineProperty(_ru,"Open","Открыть"),_defineProperty(_ru,"Close","Закрыть"),_defineProperty(_ru,"Post was deleted by","Пост был удалён"),_defineProperty(_ru,"it's author","автором"),_defineProperty(_ru,"moderator","модератором"),_defineProperty(_ru,"File removed","Файл удалён"),_defineProperty(_ru,"Settings","Настройки"),_defineProperty(_ru,"Supported file formats","Поддерживаемые форматы файлов"),_defineProperty(_ru,"Maximum file size","Маскимальный размер файла"),_defineProperty(_ru,"Images greater than","Изображения, большие"),_defineProperty(_ru,"will be thumbnailed","будут уменьшены"),_defineProperty(_ru,"Currently",""),_defineProperty(_ru,"unique user posts","уникальных постов"),_defineProperty(_ru,"FAQ & rules","FAQ и правила"),_defineProperty(_ru,"Catalog","Каталог"),_defineProperty(_ru,"Expand","Раскрыть"),_defineProperty(_ru,"Other","Дополнительно"),_defineProperty(_ru,"for post and file deletion","для удаления постов и файлов"),_defineProperty(_ru,"Delete post","Удалить пост"),_defineProperty(_ru,"File Only","Только файл"),_defineProperty(_ru,"Previous","Назад"),_defineProperty(_ru,"Next","Дальше"),_defineProperty(_ru,"Preview selected image","Предпросмотр выбранного изображения"),_defineProperty(_ru,"Reply","Ответ"),_defineProperty(_ru,"Submit","Отправить"),_defineProperty(_ru,"Confirm post sending","Подтверждение отправки поста"),_defineProperty(_ru,"Please enter CAPTCHA:","Введите символы с картинки:"),_defineProperty(_ru,'Please press "submit" to send your post.','Нажмите "Submit" чтобы отправить пост.'),_defineProperty(_ru,"You are now able to post.","Теперь вы можете постить!"),_defineProperty(_ru,"Enter message first!","Вы ничего не написали в сообщении!"),_defineProperty(_ru,"You need to wait","Необходимо подождать"),_defineProperty(_ru,"Or calculate POW","Или вычислите POW"),_defineProperty(_ru,"seconds","с"),_defineProperty(_ru,"Select file you want to post.","Выберите файл, который вы хотите запостить"),_defineProperty(_ru,"You are using old browser (Web Workers are not supported)!","Вы используете устаревший браузер (Web Workers не поддерживаются)!"),_defineProperty(_ru,'Please press "submit" to send your post.',"Пожалуйста, подтвердите отправку поста."),_ru),en:{}},TimeText={months_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months_full:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdays_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},TimeFormats={MMMM:["\x00",_("January"),_("February"),_("March"),_("April"),_("May"),_("June"),_("July"),_("August"),_("September"),_("October"),_("November"),_("December")],MMM:["",_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")],dddd:["",_("Sunday"),_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday")],ddd:["",_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thu"),_("Fri"),_("Sat")]};document.addEventListener("DOMContentLoaded",function(){window.addEventListener("focus",checkStyle)});